<div class="p-d-flex p-flex-column" style="height: 100%">
  
  <!-- Component Action Bar -->
  <div class="p-d-flex p-jc-end p-mb-3">
    <p-button 
      label="Refresh" 
      icon="pi pi-refresh"
      (onClick)="loadMyTasks()"
      [loading]="loading()"
      size="small">
    </p-button>
  </div>

  <!-- Table Content -->
  <p-table 
    [value]="workItems()" 
    [loading]="loading()"
    [paginator]="true" 
    [rows]="10"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [sortMode]="'multiple'"
    [scrollable]="true"
    scrollHeight="flex"
    styleClass="p-datatable-sm"
    [responsive]="true">
    
    <!-- ID Column -->
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id">
          ID
          <p-sortIcon field="id"></p-sortIcon>
        </th>
        <th pSortableColumn="title">
          Title
          <p-sortIcon field="title"></p-sortIcon>
        </th>
        <th pSortableColumn="type">
          Type
          <p-sortIcon field="type"></p-sortIcon>
        </th>
        <th pSortableColumn="state">
          State
          <p-sortIcon field="state"></p-sortIcon>
        </th>
        <th pSortableColumn="priority">
          Priority
          <p-sortIcon field="priority"></p-sortIcon>
        </th>
        <th>Story Points</th>
        <th pSortableColumn="changed_date">
          Updated
          <p-sortIcon field="changed_date"></p-sortIcon>
        </th>
      </tr>
    </ng-template>
    
    <!-- Data Rows -->
    <ng-template pTemplate="body" let-item>
      <tr>
        <td>{{ item.id }}</td>
        <td>
          <span class="title-cell">
            {{ item.title || 'Untitled' }}
          </span>
        </td>
        <td>
          <p-tag 
            [value]="item.type || 'Unknown'"
            severity="info">
          </p-tag>
        </td>
        <td>
          <p-tag 
            [value]="item.state || 'Unknown'"
            [severity]="getStateSeverity(item.state)">
          </p-tag>
        </td>
        <td>
          <p-tag 
            [value]="getPriorityLabel(item.priority)"
            [severity]="getPrioritySeverity(item.priority)">
          </p-tag>
        </td>
        <td class="p-text-center">
          {{ item.story_points || '-' }}
        </td>
        <td>
          {{ item.changed_date ? (item.changed_date | date:'short') : '-' }}
        </td>
      </tr>
    </ng-template>

    <!-- Empty State with PrimeNG utilities -->
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7" class="p-text-center">
          <div class="p-p-6">
            <i class="pi pi-inbox p-text-6xl p-text-color-secondary p-mb-4"></i>
            <h4 class="p-text-xl p-font-semibold p-mb-2 p-text-color">No Tasks Found</h4>
            <p class="p-text-color-secondary p-m-0">You don't have any work items assigned to you.</p>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  
</div>