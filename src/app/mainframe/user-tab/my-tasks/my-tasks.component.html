<div class="my-tasks-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-title">
        <h1><i class="pi pi-check-square"></i> My Tasks</h1>
        <p>Personal productivity dashboard for your assigned work items</p>
      </div>
      
      <div class="header-stats" *ngIf="!loading()">
        <div class="stat-item">
          <span class="stat-number">{{ activeTasks() }}</span>
          <span class="stat-label">Active</span>
        </div>
        <div class="stat-item">
          <span class="stat-number">{{ highPriorityTasks() }}</span>
          <span class="stat-label">High Priority</span>
        </div>
        <div class="stat-item">
          <span class="stat-number">{{ thisWeekTasks() }}</span>
          <span class="stat-label">This Week</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="task-summary" *ngIf="!loading()">
    <p-card styleClass="summary-card">
      <div class="summary-content">
        <div class="summary-number">{{ activeTasks() }}</div>
        <div class="summary-label">Active Tasks</div>
        <p-tag 
          [severity]="activeTasks() > 0 ? 'info' : 'success'" 
          [value]="activeTasks() > 0 ? 'In Progress' : 'All Done'">
        </p-tag>
      </div>
    </p-card>
    
    <p-card styleClass="summary-card">
      <div class="summary-content">
        <div class="summary-number">{{ highPriorityTasks() }}</div>
        <div class="summary-label">High Priority</div>
        <p-tag 
          [severity]="highPriorityTasks() > 0 ? 'danger' : 'success'" 
          [value]="highPriorityTasks() > 0 ? 'Urgent' : 'Clear'">
        </p-tag>
      </div>
    </p-card>
    
    <p-card styleClass="summary-card">
      <div class="summary-content">
        <div class="summary-number">{{ thisWeekTasks() }}</div>
        <div class="summary-label">This Week</div>
        <p-tag severity="success" value="Updated"></p-tag>
      </div>
    </p-card>
  </div>

  <!-- Tasks Table -->
  <div class="tasks-table-container">
    <app-shared-data-table
      [config]="tableConfig()"
      [stateKey]="'my-tasks-table'"
      (refresh)="onTableRefresh()"
      (configChange)="onTableConfigChange($event)">
      
      <!-- Custom Empty State Template -->
      <ng-template #emptyTemplate>
        <div class="custom-empty-state">
          <i class="pi pi-check-circle empty-icon"></i>
          <h3>All caught up!</h3>
          <p>You have no tasks assigned. Time to take a break or pick up new work!</p>
          <p-button 
            label="Create New Task" 
            icon="pi pi-plus" 
            severity="primary"
            (onClick)="openCreateTaskDialog()">
          </p-button>
        </div>
      </ng-template>

      <!-- Custom Loading Template -->
      <ng-template #loadingTemplate>
        <div class="custom-loading">
          <div class="loading-skeleton">
            <div class="skeleton-row" *ngFor="let item of [1,2,3,4,5]">
              <div class="skeleton-cell small"></div>
              <div class="skeleton-cell large"></div>
              <div class="skeleton-cell medium"></div>
              <div class="skeleton-cell small"></div>
              <div class="skeleton-cell medium"></div>
              <div class="skeleton-cell small"></div>
            </div>
          </div>
        </div>
      </ng-template>

    </app-shared-data-table>
  </div>

</div>

<!-- Create Task Dialog -->
<p-dialog 
  header="Create New Task" 
  [visible]="showCreateTaskDialog()"
  (onHide)="closeCreateTaskDialog()"
  [modal]="true"
  [style]="{ width: '600px' }"
  [draggable]="false"
  [resizable]="false">

  <div class="create-task-form">
    <div class="form-placeholder">
      <i class="pi pi-plus-circle" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
      <h3>Create New Task</h3>
      <p>Task creation form will be implemented here</p>
      
      <div class="form-preview">
        <ul>
          <li>Title (required)</li>
          <li>Description</li>
          <li>Work Item Type (Task, Bug, User Story)</li>
          <li>Priority</li>
          <li>Story Points/Effort</li>
          <li>Area Path</li>
          <li>Iteration Path</li>
        </ul>
      </div>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button 
        label="Cancel" 
        icon="pi pi-times"
        (onClick)="closeCreateTaskDialog()"
        severity="secondary">
      </p-button>
      <p-button 
        label="Create Task" 
        icon="pi pi-check"
        severity="primary"
        [disabled]="true">
      </p-button>
    </div>
  </ng-template>

</p-dialog>